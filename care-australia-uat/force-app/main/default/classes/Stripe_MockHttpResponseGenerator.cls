/**
 * Class Name: Stripe_MockHttpResponseGenerator
 * Auhtor: Gerent Team
 * Description: class to implement and manage the httpCallout in test mode which will be utilized in the testmethods
 * Modification Details: Amit Goyal - 29/09/2022 - Initial version created
 * */
@isTest
global class Stripe_MockHttpResponseGenerator implements HttpCalloutMock{
    global Integer statusCode;
    
    global Stripe_MockHttpResponseGenerator(Integer statusCode) {
        this.statusCode=statusCode;
    }
    
  global HTTPResponse respond(HTTPRequest req) {
        //System.assertEquals('https://example.com/example/test', req.getEndpoint());
        //System.assertEquals('GET', req.getMethod());
        
        // Create a fake response
        HttpResponse res = new HttpResponse();
        res.setHeader('Content-Type', 'application/json');
        system.debug('### Endpoint: '+req.getEndpoint());
        if(req.getEndpoint().endsWith('customers')) {
            res.setBody('{"id":"cus_MaqSawqM4GJrL8","object":"customer","address":null,"balance":0,"created":1665480530,"currency":null,"default_currency":null,"default_source":null,"delinquent":false,"description":null,"discount":null,"email":"test@213test.com","invoice_prefix":"89849F7E","invoice_settings":{"custom_fields":null,"default_payment_method":null,"footer":null,"rendering_options":null},"livemode":false,"metadata":{},"name":"testingName","next_invoice_sequence":1,"phone":"+6142432423","preferred_locales":[],"shipping":null,"tax_exempt":"none","test_clock":null}');
        } else if(req.getEndpoint().endsWith('subscriptions')) {
            res.setBody('{"id":"evt_1LnFHcGGWgtqSxG4Tt3LHvJA","object":"event","api_version":"2020-08-27","created":1664429260,"data":{"object":{"id":"sub_1LnFHbGGWgtqSxG4HZOrRj2u","object":"subscription","application":null,"application_fee_percent":null,"automatic_tax":{"enabled":false},"billing_cycle_anchor":1664546400,"billing_thresholds":null,"cancel_at":1690588800,"cancel_at_period_end":false,"canceled_at":1664429259,"collection_method":"charge_automatically","created":1664429259,"currency":"aud","current_period_end":1664546400,"current_period_start":1664429259,"customer":"cus_MWHbeeJlTnGCgG","days_until_due":null,"default_payment_method":null,"default_source":null,"default_tax_rates":[],"description":null,"discount":null,"ended_at":null,"items":{"object":"list","data":[{"id":"si_MWHrNd0SRx6VA0","object":"subscription_item","billing_thresholds":null,"created":1664429259,"metadata":{},"plan":{"id":"price_1LnFHbGGWgtqSxG4kCsTDbpg","object":"plan","active":false,"aggregate_usage":null,"amount":1000,"amount_decimal":"1000","billing_scheme":"per_unit","created":1664429259,"currency":"aud","interval":"month","interval_count":1,"livemode":false,"metadata":{},"nickname":null,"product":"prod_MW6y2WdwsxIhaR","tiers_mode":null,"transform_usage":null,"trial_period_days":null,"usage_type":"licensed"},"price":{"id":"price_1LnFHbGGWgtqSxG4kCsTDbpg","object":"price","active":false,"billing_scheme":"per_unit","created":1664429259,"currency":"aud","custom_unit_amount":null,"livemode":false,"lookup_key":null,"metadata":{},"nickname":null,"product":"prod_MW6y2WdwsxIhaR","recurring":{"aggregate_usage":null,"interval":"month","interval_count":1,"trial_period_days":null,"usage_type":"licensed"},"tax_behavior":"unspecified","tiers_mode":null,"transform_quantity":null,"type":"recurring","unit_amount":1000,"unit_amount_decimal":"1000"},"quantity":1,"subscription":"sub_1LnFHbGGWgtqSxG4HZOrRj2u","tax_rates":[]}],"has_more":false,"total_count":1,"url":"/v1/subscription_items?subscription=sub_1LnFHbGGWgtqSxG4HZOrRj2u"},"latest_invoice":"in_1LnFHbGGWgtqSxG44g8HF9QZ","livemode":false,"metadata":{"salesforce_rd_id":"a099t000000LldRAAS"},"next_pending_invoice_item_invoice":null,"pause_collection":null,"payment_settings":{"payment_method_options":null,"payment_method_types":null,"save_default_payment_method":"off"},"pending_invoice_item_interval":null,"pending_setup_intent":null,"pending_update":null,"plan":{"id":"price_1LnFHbGGWgtqSxG4kCsTDbpg","object":"plan","active":false,"aggregate_usage":null,"amount":1000,"amount_decimal":"1000","billing_scheme":"per_unit","created":1664429259,"currency":"aud","interval":"month","interval_count":1,"livemode":false,"metadata":{},"nickname":null,"product":"prod_MW6y2WdwsxIhaR","tiers_mode":null,"transform_usage":null,"trial_period_days":null,"usage_type":"licensed"},"quantity":1,"schedule":null,"start_date":1664429259,"status":"active","test_clock":null,"transfer_data":null,"trial_end":null,"trial_start":null}},"livemode":false,"pending_webhooks":1,"request":{"id":"req_kzuwTKBbHNjcdx","idempotency_key":"a5c19c79-edd7-4ef2-a200-ffe1d55415bb"},"type":"customer.subscription.created"}');
        } else if(req.getEndpoint().endsWith('payment_methods')) {
           res.setBody('{"id":"pm_1LqzAHGGWgtqSxG4LYV010Rd","object":"payment_method","au_becs_debit":{"bsb_number":"000000","fingerprint":"x7VRWWDY9TclyfBc","last4":"3456"},"billing_details":{"address":{"city":null,"country":null,"line1":null,"line2":null,"postal_code":null,"state":null},"email":null,"name":null,"phone":null},"card":{"brand":"visa","checks":{"address_line1_check":null,"address_postal_code_check":null,"cvc_check":null},"country":"US","exp_month":10,"exp_year":2023,"fingerprint":"k3Oq1WWP1nBVr7hR","funding":"credit","generated_from":null,"last4":"4242","networks":{"available":["visa"],"preferred":null},"three_d_secure_usage":{"supported":true},"wallet":null},"created":1665320614,"customer":null,"livemode":false,"metadata":{},"type":"card"}');
        } else if(req.getEndpoint().contains('pm_1LyIC6GGWgtqSxG4BaTbZB68')) {
           res.setBody('{"id":"pm_1LyIC6GGWgtqSxG4BaTbZB68","object":"payment_method","au_becs_debit":{"bsb_number":"000000","fingerprint":"x7VRWWDY9TclyfBc","last4":"3456"},"billing_details":{"address":{"city":null,"country":null,"line1":null,"line2":null,"postal_code":null,"state":null},"email":null,"name":null,"phone":null},"card":{"brand":"visa","checks":{"address_line1_check":null,"address_postal_code_check":null,"cvc_check":null},"country":"US","exp_month":10,"exp_year":2023,"fingerprint":"k3Oq1WWP1nBVr7hR","funding":"credit","generated_from":null,"last4":"4242","networks":{"available":["visa"],"preferred":null},"three_d_secure_usage":{"supported":true},"wallet":null},"created":1665320614,"customer":null,"livemode":false,"metadata":{},"type":"card"}');
        } else if(req.getEndpoint().endsWith('payment_intents')) {
            res.setBody('{"id":"pi_3Lrf0nGGWgtqSxG41Ccm4Twn","object":"payment_intent","amount":500,"amount_capturable":0,"amount_details":{"tip":{}},"amount_received":0,"application":null,"application_fee_amount":null,"automatic_payment_methods":null,"canceled_at":null,"cancellation_reason":null,"capture_method":"automatic","charges":{"object":"list","data":[],"has_more":false,"total_count":0,"url":"/v1/charges?payment_intent=pi_3Lrf0nGGWgtqSxG41Ccm4Twn"},"client_secret":"pi_3Lrf0nGGWgtqSxG41Ccm4Twn_secret_TkrK987N43EjYKaTbIv0R36Kx","confirmation_method":"automatic","created":1665481473,"currency":"aud","customer":null,"description":null,"invoice":null,"last_payment_error":null,"livemode":false,"metadata":{},"next_action":null,"on_behalf_of":null,"payment_method":null,"payment_method_options":{"card":{"installments":null,"mandate_options":null,"network":null,"request_three_d_secure":"automatic"}},"payment_method_types":["card"],"processing":null,"receipt_email":null,"review":null,"setup_future_usage":null,"shipping":null,"source":null,"statement_descriptor":null,"statement_descriptor_suffix":null,"status":"requires_payment_method","transfer_data":null,"transfer_group":null}');
        } else if(req.getEndpoint().endsWith('prices')) {
            res.setBody('{"id":"price_1LnnOFGGWgtqSxG4KLs4Z3dT","object":"price","active":true,"billing_scheme":"per_unit","created":1664560367,"currency":"aud","custom_unit_amount":null,"livemode":false,"lookup_key":null,"metadata":{},"nickname":null,"product":"prod_MWr6AZu6P3dCoh","recurring":{"aggregate_usage":null,"interval":"month","interval_count":1,"trial_period_days":null,"usage_type":"licensed"},"tax_behavior":"unspecified","tiers_mode":null,"transform_quantity":null,"type":"recurring","unit_amount":100,"unit_amount_decimal":"100"}');
        } else if(req.getEndpoint().endsWith('products')) {
            res.setBody('{"id":"prod_MW6y2WdwsxIhaR","object":"product","active":true,"attributes":[],"created":1664388760,"default_price":null,"description":null,"images":[],"livemode":false,"metadata":{"sf_product_id":"7019t000003Mze8AAC"},"name":"2006CAREGifts","package_dimensions":null,"shippable":null,"statement_descriptor":null,"tax_code":null,"type":"service","unit_label":null,"updated":1664388760,"url":null}');
        } else if(req.getEndpoint().endsWith('subscription_schedules')){
            res.setBody('{"id":"sub_sched_1LmXAfGGWgtqSxG4Kq0p6cr3","object":"subscription_schedule","application":null,"canceled_at":null,"completed_at":null,"created":1664259693,"current_phase":{"end_date":1695968464,"start_date":1663655163},"customer":"cus_MSVrrxIJv5p2hR","default_settings":{"application_fee_percent":null,"automatic_tax":{"enabled":false},"billing_cycle_anchor":"automatic","billing_thresholds":null,"collection_method":"charge_automatically","default_payment_method":null,"default_source":null,"description":null,"invoice_settings":null,"transfer_data":null},"end_behavior":"release","livemode":false,"metadata":{"stripe_key":"test"},"phases":[{"add_invoice_items":[],"application_fee_percent":null,"billing_cycle_anchor":null,"billing_thresholds":null,"collection_method":null,"coupon":null,"currency":"aud","default_payment_method":null,"default_tax_rates":[],"description":null,"end_date":1695968464,"invoice_settings":null,"items":[{"billing_thresholds":null,"plan":"price_1LmXAfGGWgtqSxG4es9mzwn2","price":"price_1LmXAfGGWgtqSxG4es9mzwn2","quantity":1,"tax_rates":[]}],"metadata":{},"proration_behavior":"create_prorations","start_date":1663655163,"transfer_data":null,"trial_end":null}],"released_at":null,"released_subscription":null,"renewal_interval":null,"status":"active","subscription":"sub_1LmXAfGGWgtqSxG43G3UkNZV","test_clock":null}');
        } else if(req.getEndpoint().endsWith('tokens')){
            res.setBody('{"id":"tok_1LmKjWGGWgtqSxG4bJwbv3rp","object":"token","card":{"id":"card_1LmKjVGGWgtqSxG40CtDRlmQ","object":"card","address_city":null,"address_country":null,"address_line1":null,"address_line1_check":null,"address_line2":null,"address_state":null,"address_zip":null,"address_zip_check":null,"brand":"Visa","country":"US","cvc_check":null,"dynamic_last4":null,"exp_month":12,"exp_year":2034,"fingerprint":"k3Oq1WWP1nBVr7hR","funding":"credit","last4":"4242","metadata":{},"name":null,"tokenization_method":null},"client_ip":"122.181.97.189","created":1664211882,"livemode":false,"type":"card","used":false}');
        } else if(req.getEndpoint().contains('cus_MWHbeeJlTnGCgG')){
            res.setBody('{"id":"tok_1LrKNEGGWgtqSxG4ISdRomY5","object":"token","card":{"id":"card_1LrKNEGGWgtqSxG457nemCcN","object":"card","address_city":null,"address_country":null,"address_line1":null,"address_line1_check":null,"address_line2":null,"address_state":null,"address_zip":null,"address_zip_check":null,"brand":"Visa","country":"GB","cvc_check":null,"dynamic_last4":null,"exp_month":12,"exp_year":2034,"fingerprint":"py6Sgj21YL7oOG1C","funding":"credit","last4":"3178","metadata":{},"name":null,"tokenization_method":null},"client_ip":"61.95.223.70","created":1665402140,"livemode":false,"type":"card","used":false}');
        } else if(req.getEndpoint().endsWith('cus_MQfbVwXxlomTAl')){
            res.setBody('{"id":"cus_MQfbVwXxlomTAl","object":"customer","address":null,"balance":0,"created":1665480530,"currency":null,"default_currency":null,"default_source":null,"delinquent":false,"description":null,"discount":null,"email":"test@213test.com","invoice_prefix":"89849F7E","invoice_settings":{"custom_fields":null,"default_payment_method":null,"footer":null,"rendering_options":null},"livemode":false,"metadata":{},"name":"testingName","next_invoice_sequence":1,"phone":"+6142432423","preferred_locales":[],"shipping":null,"tax_exempt":"none","test_clock":null}');
        } else if(req.getEndpoint().contains('cus_MaqNgZCf0WUlah')){
            res.setBody('{"id":"tok_1LrKNEGGWgtqSxG4ISdRomY5","object":"token","card":{"id":"card_1LrKNEGGWgtqSxG457nemCcN","object":"card","address_city":null,"address_country":null,"address_line1":null,"address_line1_check":null,"address_line2":null,"address_state":null,"address_zip":null,"address_zip_check":null,"brand":"Visa","country":"GB","cvc_check":null,"dynamic_last4":null,"exp_month":12,"exp_year":2034,"fingerprint":"py6Sgj21YL7oOG1C","funding":"credit","last4":"3178","metadata":{},"name":null,"tokenization_method":null},"client_ip":"61.95.223.70","created":1665402140,"livemode":false,"type":"card","used":false}');
        } else if(req.getEndpoint().contains('pm_1LqzAHGGWgtqSxG4LYV010Rd')){
            res.setBody('{"id":"pm_1LqzAHGGWgtqSxG4LYV010Rd","object":"payment_method","au_becs_debit":{"bsb_number":"000000","fingerprint":"x7VRWWDY9TclyfBc","last4":"3456"},"billing_details":{"address":{"city":null,"country":null,"line1":null,"line2":null,"postal_code":null,"state":null},"email":null,"name":null,"phone":null},"card":{"brand":"visa","checks":{"address_line1_check":null,"address_postal_code_check":null,"cvc_check":null},"country":"US","exp_month":10,"exp_year":2023,"fingerprint":"k3Oq1WWP1nBVr7hR","funding":"credit","generated_from":null,"last4":"4242","networks":{"available":["visa"],"preferred":null},"three_d_secure_usage":{"supported":true},"wallet":null},"created":1665320614,"customer":"cus_MaqSawqM4GJrL8","livemode":false,"metadata":{},"type":"card"}');
        } else if(req.getEndpoint().contains('pi_3Lrf0nGGWgtqSxG41Ccm4Twn')){
            res.setBody('{"id":"price_1LnnOFGGWgtqSxG4KLs4Z3dT","object":"price","active":true,"billing_scheme":"per_unit","created":1664560367,"currency":"aud","custom_unit_amount":null,"livemode":false,"lookup_key":null,"metadata":{},"nickname":null,"product":"prod_MWr6AZu6P3dCoh","recurring":{"aggregate_usage":null,"interval":"month","interval_count":1,"trial_period_days":null,"usage_type":"licensed"},"tax_behavior":"unspecified","tiers_mode":null,"transform_quantity":null,"type":"recurring","unit_amount":100,"unit_amount_decimal":"100"}');
        } else if(req.getEndpoint().contains('card_1LtqyZGGWgtqSxG4c7qq1Gaf')){
            res.setBody('{"id":"card_1LtqyZGGWgtqSxG4c7qq1Gaf","object":"card","address_city":null,"address_country":null,"address_line1":null,"address_line1_check":null,"address_line2":null,"address_state":null,"address_zip":null,"address_zip_check":null,"brand":"Visa","country":"US","customer":"cus_Md7Cfyev9dZ36G","cvc_check":"pass","dynamic_last4":null,"exp_month":4,"exp_year":2026,"fingerprint":"k3Oq1WWP1nBVr7hR","funding":"credit","last4":"4242","metadata":{},"name":null,"tokenization_method":null}');
        } else if(req.getEndpoint().endsWith('invoices/search?query=created>=1665599251&limit=100')){
            res.setBody('{"object":"search_result","data":[{"id":"in_1LuFzDGGWgtqSxG4225rYbC3","object":"invoice","account_country":"AU","account_name":"CareAustralia","account_tax_ids":null,"amount_due":300,"amount_paid":300,"amount_remaining":0,"application":null,"application_fee_amount":null,"attempt_count":1,"attempted":true,"auto_advance":false,"automatic_tax":{"enabled":false,"status":null},"billing_reason":"subscription_cycle","charge":"ch_3LuGvlGGWgtqSxG40cg4htBA","collection_method":"charge_automatically","created":"'+ Datetime.now().getTime()/1000+'","currency":"aud","custom_fields":null,"customer":"cus_MEIO6YQafQq7oj","customer_address":null,"customer_email":null,"customer_name":"GAVINMCDONNELL","customer_phone":null,"customer_shipping":null,"customer_tax_exempt":"none","customer_tax_ids":[],"default_payment_method":null,"default_source":null,"default_tax_rates":[],"description":null,"discount":null,"discounts":[],"due_date":null,"ending_balance":0,"footer":null,"from_invoice":null,"hosted_invoice_url":"https://invoice.stripe.com/i/acct_1LIkLGGGWgtqSxG4/test_YWNjdF8xTElrTEdHR1dndHFTeEc0LF9NZFgzVjBnYXdUWFBQenVSWEJ6dFZ5c05KNEgxTmxFLDU2NjU0Nzk4020092IEhR8e?s=ap","invoice_pdf":"https://pay.stripe.com/invoice/acct_1LIkLGGGWgtqSxG4/test_YWNjdF8xTElrTEdHR1dndHFTeEc0LF9NZFgzVjBnYXdUWFBQenVSWEJ6dFZ5c05KNEgxTmxFLDU2NjU0Nzk50200SmOdKJRb/pdf?s=ap","last_finalization_error":null,"latest_revision":null,"lines":{"object":"list","data":[{"id":"il_1LuFzDGGWgtqSxG45iv8jVI3","object":"line_item","amount":300,"amount_excluding_tax":300,"currency":"aud","description":"3×RecurringDonation(at$1.00/every4weeks)","discount_amounts":[],"discountable":true,"discounts":[],"livemode":false,"metadata":{},"period":{"end":1668519000,"start":1666099800},"plan":{"id":"price_1LJB0JGGWgtqSxG4qBM8ywVC","object":"plan","active":true,"aggregate_usage":null,"amount":100,"amount_decimal":"100","billing_scheme":"per_unit","created":1657262971,"currency":"aud","interval":"week","interval_count":4,"livemode":false,"metadata":{},"nickname":"DonationAmount","product":"prod_M1C8j7YNLrXN9x","tiers_mode":null,"transform_usage":null,"trial_period_days":null,"usage_type":"licensed"},"price":{"id":"price_1LJB0JGGWgtqSxG4qBM8ywVC","object":"price","active":true,"billing_scheme":"per_unit","created":1657262971,"currency":"aud","custom_unit_amount":null,"livemode":false,"lookup_key":null,"metadata":{},"nickname":"DonationAmount","product":"prod_M1C8j7YNLrXN9x","recurring":{"aggregate_usage":null,"interval":"week","interval_count":4,"trial_period_days":null,"usage_type":"licensed"},"tax_behavior":"inclusive","tiers_mode":null,"transform_quantity":null,"type":"recurring","unit_amount":100,"unit_amount_decimal":"100"},"proration":false,"proration_details":{"credited_items":null},"quantity":3,"subscription":"sub_1Li5pYGGWgtqSxG4QsaC8EvZ","subscription_item":"si_MQxlWJj6vZfuge","tax_amounts":[],"tax_rates":[],"type":"subscription","unit_amount_excluding_tax":"100"}],"has_more":false,"total_count":1,"url":"/v1/invoices/in_1LuFzDGGWgtqSxG4225rYbC3/lines"},"livemode":false,"metadata":{},"next_payment_attempt":null,"number":"8E995044-0033","on_behalf_of":null,"paid":true,"paid_out_of_band":false,"payment_intent":"pi_3LuGvlGGWgtqSxG40NwsV9FS","payment_settings":{"default_mandate":null,"payment_method_options":null,"payment_method_types":null},"period_end":1666099800,"period_start":1663680600,"post_payment_credit_notes_amount":0,"pre_payment_credit_notes_amount":0,"quote":null,"receipt_number":null,"rendering_options":null,"starting_balance":0,"statement_descriptor":null,"status":"paid","status_transitions":{"finalized_at":1666103888,"marked_uncollectible_at":null,"paid_at":1666103888,"voided_at":null},"subscription":"sub_1Li5pYGGWgtqSxG4QsaC8EvZ","subtotal":300,"subtotal_excluding_tax":300,"tax":null,"test_clock":null,"total":300,"total_discount_amounts":[],"total_excluding_tax":300,"total_tax_amounts":[],"transfer_data":null,"webhooks_delivered_at":1666100260}],"has_more":true,"next_page":"WzE2NjU0ODE2MzcuMzU4NzcxXQ==","url":"/v1/invoices/search"}');
        } else if(req.getEndpoint().endsWith('payment_intents/search?query=created>=1665599251&limit=100')){
            res.setBody('{"object":"search_result","data":[{"id":"pi_3LuGvlGGWgtqSxG40NwsV9FS","object":"payment_intent","amount":300,"amount_capturable":0,"amount_details":{"tip":{}},"amount_received":300,"application":null,"application_fee_amount":null,"automatic_payment_methods":null,"canceled_at":null,"cancellation_reason":null,"capture_method":"automatic","charges":{"object":"list","data":[{"id":"ch_3LuGvlGGWgtqSxG40cg4htBA","object":"charge","amount":300,"amount_captured":300,"amount_refunded":0,"application":null,"application_fee":null,"application_fee_amount":null,"balance_transaction":"txn_3LuGvlGGWgtqSxG4087ZRNcP","billing_details":{"address":{"city":null,"country":null,"line1":null,"line2":null,"postal_code":null,"state":null},"email":null,"name":"GAVINMCDONNELL","phone":null},"calculated_statement_descriptor":"CAREAUSTRALIA","captured":true,"created":'+ Datetime.now().getTime()/1000+',"currency":"aud","customer":"cus_MEIO6YQafQq7oj","description":"Subscriptionupdate","destination":null,"dispute":null,"disputed":false,"failure_balance_transaction":null,"failure_code":null,"failure_message":null,"fraud_details":{},"invoice":"in_1LuFzDGGWgtqSxG4225rYbC3","livemode":false,"metadata":{},"on_behalf_of":null,"order":null,"outcome":{"network_status":"approved_by_network","reason":null,"risk_level":"normal","risk_score":38,"seller_message":"Paymentcomplete.","type":"authorized"},"paid":true,"payment_intent":"pi_3LuGvlGGWgtqSxG40NwsV9FS","payment_method":"card_1LVpnbGGWgtqSxG4WvKYhBFD","payment_method_details":{"card":{"brand":"visa","checks":{"address_line1_check":null,"address_postal_code_check":null,"cvc_check":null},"country":"US","exp_month":3,"exp_year":2025,"fingerprint":"k3Oq1WWP1nBVr7hR","funding":"credit","installments":null,"last4":"4242","mandate":null,"network":"visa","three_d_secure":null,"wallet":null},"type":"card"},"receipt_email":null,"receipt_number":null,"receipt_url":"https://pay.stripe.com/receipts/invoices/CAcaFwoVYWNjdF8xTElrTEdHR1dndHFTeEc0KOzCu5oGMgbF-4STZO46LBaIbL5HOmOZ8YlSBy_1BO8xIKjFAPztZitEFH1O8_CPVFsrXq4y2npheDib?s=ap","refunded":false,"refunds":{"object":"list","data":[],"has_more":false,"total_count":0,"url":"/v1/charges/ch_3LuGvlGGWgtqSxG40cg4htBA/refunds"},"review":null,"shipping":null,"source":{"id":"card_1LVpnbGGWgtqSxG4WvKYhBFD","object":"card","address_city":null,"address_country":null,"address_line1":null,"address_line1_check":null,"address_line2":null,"address_state":null,"address_zip":null,"address_zip_check":null,"brand":"Visa","country":"US","customer":"cus_MEIO6YQafQq7oj","cvc_check":null,"dynamic_last4":null,"exp_month":3,"exp_year":2025,"fingerprint":"k3Oq1WWP1nBVr7hR","funding":"credit","last4":"4242","metadata":{},"name":"GAVINMCDONNELL","tokenization_method":null},"source_transfer":null,"statement_descriptor":null,"statement_descriptor_suffix":null,"status":"succeeded","transfer_data":null,"transfer_group":null}],"has_more":false,"total_count":1,"url":"/v1/charges?payment_intent=pi_3LuGvlGGWgtqSxG40NwsV9FS"},"client_secret":"pi_3LuGvlGGWgtqSxG40NwsV9FS_secret_UJBO5JbvnOgXJd74p4tUHsAuN","confirmation_method":"automatic","created":1666103889,"currency":"aud","customer":"cus_MEIO6YQafQq7oj","description":"Subscriptionupdate","invoice":"in_1LuFzDGGWgtqSxG4225rYbC3","last_payment_error":null,"livemode":false,"metadata":{},"next_action":null,"on_behalf_of":null,"payment_method":null,"payment_method_options":{"au_becs_debit":{},"card":{"installments":null,"mandate_options":null,"network":null,"request_three_d_secure":"automatic"}},"payment_method_types":["au_becs_debit","card"],"processing":null,"receipt_email":null,"review":null,"setup_future_usage":null,"shipping":null,"source":"card_1LVpnbGGWgtqSxG4WvKYhBFD","statement_descriptor":null,"statement_descriptor_suffix":null,"status":"succeeded","transfer_data":null,"transfer_group":null}],"has_more":true,"next_page":"WzE2NjU5MTA0NzMuMjgyNTQ5Nl0=","url":"/v1/payment_intents/search"}');
        } else if(req.getEndpoint().endsWith('charges/search?query=created>=1665599251&limit=100')){
            res.setBody('{"object":"search_result","data":[{"id":"ch_3LuGvlGGWgtqSxG40cg4htBA","object":"charge","amount":300,"amount_captured":300,"amount_refunded":0,"application":null,"application_fee":null,"application_fee_amount":null,"balance_transaction":"txn_3LuGvlGGWgtqSxG4087ZRNcP","billing_details":{"address":{"city":null,"country":null,"line1":null,"line2":null,"postal_code":null,"state":null},"email":null,"name":"GAVINMCDONNELL","phone":null},"calculated_statement_descriptor":"CAREAUSTRALIA","captured":true,"created":'+ Datetime.now().getTime()/1000 +',"currency":"aud","customer":"cus_MEIO6YQafQq7oj","description":"Subscriptionupdate","destination":null,"dispute":null,"disputed":false,"failure_balance_transaction":null,"failure_code":null,"failure_message":null,"fraud_details":{},"invoice":"in_1LuFzDGGWgtqSxG4225rYbC3","livemode":false,"metadata":{},"on_behalf_of":null,"order":null,"outcome":{"network_status":"approved_by_network","reason":null,"risk_level":"normal","risk_score":38,"seller_message":"Paymentcomplete.","type":"authorized"},"paid":true,"payment_intent":"pi_3LuGvlGGWgtqSxG40NwsV9FS","payment_method":"card_1LVpnbGGWgtqSxG4WvKYhBFD","payment_method_details":{"card":{"brand":"visa","checks":{"address_line1_check":null,"address_postal_code_check":null,"cvc_check":null},"country":"US","exp_month":3,"exp_year":2025,"fingerprint":"k3Oq1WWP1nBVr7hR","funding":"credit","installments":null,"last4":"4242","mandate":null,"network":"visa","three_d_secure":null,"wallet":null},"type":"card"},"receipt_email":null,"receipt_number":null,"receipt_url":"https://pay.stripe.com/receipts/invoices/CAcaFwoVYWNjdF8xTElrTEdHR1dndHFTeEc0KPHBu5oGMgZjNCk9RwY6LBYQ7k-Adl4DrBr8nHJF02adPp-9hbIqy0SgPFVCMYgayTpIpJ_Z1D_ilZcX?s=ap","refunded":false,"refunds":{"object":"list","data":[],"has_more":false,"total_count":0,"url":"/v1/charges/ch_3LuGvlGGWgtqSxG40cg4htBA/refunds"},"review":null,"shipping":null,"source":{"id":"card_1LVpnbGGWgtqSxG4WvKYhBFD","object":"card","address_city":null,"address_country":null,"address_line1":null,"address_line1_check":null,"address_line2":null,"address_state":null,"address_zip":null,"address_zip_check":null,"brand":"Visa","country":"US","customer":"cus_MEIO6YQafQq7oj","cvc_check":null,"dynamic_last4":null,"exp_month":3,"exp_year":2025,"fingerprint":"k3Oq1WWP1nBVr7hR","funding":"credit","last4":"4242","metadata":{},"name":"GAVINMCDONNELL","tokenization_method":null},"source_transfer":null,"statement_descriptor":null,"statement_descriptor_suffix":null,"status":"succeeded","transfer_data":null,"transfer_group":null}],"has_more":true,"next_page":"WzE2NjU3NTYxNzkuNDU2ODcxNV0=","url":"/v1/charges/search"}');
        } else if(req.getEndpoint().contains('WzE2NjU0ODE2MzcuMzU4NzcxXQ')){
            res.setBody('{"object":"search_result","data":[{"id":"in_1LuFzDGGWgtqSxG4225rYbC3","object":"invoice","account_country":"AU","account_name":"CareAustralia","account_tax_ids":null,"amount_due":300,"amount_paid":300,"amount_remaining":0,"application":null,"application_fee_amount":null,"attempt_count":1,"attempted":true,"auto_advance":false,"automatic_tax":{"enabled":false,"status":null},"billing_reason":"subscription_cycle","charge":"ch_3LuGvlGGWgtqSxG40cg4htBA","collection_method":"charge_automatically","created":"'+ Datetime.now().getTime()/1000+'","currency":"aud","custom_fields":null,"customer":"cus_MEIO6YQafQq7oj","customer_address":null,"customer_email":null,"customer_name":"GAVINMCDONNELL","customer_phone":null,"customer_shipping":null,"customer_tax_exempt":"none","customer_tax_ids":[],"default_payment_method":null,"default_source":null,"default_tax_rates":[],"description":null,"discount":null,"discounts":[],"due_date":null,"ending_balance":0,"footer":null,"from_invoice":null,"hosted_invoice_url":"https://invoice.stripe.com/i/acct_1LIkLGGGWgtqSxG4/test_YWNjdF8xTElrTEdHR1dndHFTeEc0LF9NZFgzVjBnYXdUWFBQenVSWEJ6dFZ5c05KNEgxTmxFLDU2NjU0Nzk4020092IEhR8e?s=ap","invoice_pdf":"https://pay.stripe.com/invoice/acct_1LIkLGGGWgtqSxG4/test_YWNjdF8xTElrTEdHR1dndHFTeEc0LF9NZFgzVjBnYXdUWFBQenVSWEJ6dFZ5c05KNEgxTmxFLDU2NjU0Nzk50200SmOdKJRb/pdf?s=ap","last_finalization_error":null,"latest_revision":null,"lines":{"object":"list","data":[{"id":"il_1LuFzDGGWgtqSxG45iv8jVI3","object":"line_item","amount":300,"amount_excluding_tax":300,"currency":"aud","description":"3×RecurringDonation(at$1.00/every4weeks)","discount_amounts":[],"discountable":true,"discounts":[],"livemode":false,"metadata":{},"period":{"end":1668519000,"start":1666099800},"plan":{"id":"price_1LJB0JGGWgtqSxG4qBM8ywVC","object":"plan","active":true,"aggregate_usage":null,"amount":100,"amount_decimal":"100","billing_scheme":"per_unit","created":1657262971,"currency":"aud","interval":"week","interval_count":4,"livemode":false,"metadata":{},"nickname":"DonationAmount","product":"prod_M1C8j7YNLrXN9x","tiers_mode":null,"transform_usage":null,"trial_period_days":null,"usage_type":"licensed"},"price":{"id":"price_1LJB0JGGWgtqSxG4qBM8ywVC","object":"price","active":true,"billing_scheme":"per_unit","created":1657262971,"currency":"aud","custom_unit_amount":null,"livemode":false,"lookup_key":null,"metadata":{},"nickname":"DonationAmount","product":"prod_M1C8j7YNLrXN9x","recurring":{"aggregate_usage":null,"interval":"week","interval_count":4,"trial_period_days":null,"usage_type":"licensed"},"tax_behavior":"inclusive","tiers_mode":null,"transform_quantity":null,"type":"recurring","unit_amount":100,"unit_amount_decimal":"100"},"proration":false,"proration_details":{"credited_items":null},"quantity":3,"subscription":"sub_1Li5pYGGWgtqSxG4QsaC8EvZ","subscription_item":"si_MQxlWJj6vZfuge","tax_amounts":[],"tax_rates":[],"type":"subscription","unit_amount_excluding_tax":"100"}],"has_more":false,"total_count":1,"url":"/v1/invoices/in_1LuFzDGGWgtqSxG4225rYbC3/lines"},"livemode":false,"metadata":{},"next_payment_attempt":null,"number":"8E995044-0033","on_behalf_of":null,"paid":true,"paid_out_of_band":false,"payment_intent":"pi_3LuGvlGGWgtqSxG40NwsV9FS","payment_settings":{"default_mandate":null,"payment_method_options":null,"payment_method_types":null},"period_end":1666099800,"period_start":1663680600,"post_payment_credit_notes_amount":0,"pre_payment_credit_notes_amount":0,"quote":null,"receipt_number":null,"rendering_options":null,"starting_balance":0,"statement_descriptor":null,"status":"paid","status_transitions":{"finalized_at":1666103888,"marked_uncollectible_at":null,"paid_at":1666103888,"voided_at":null},"subscription":"sub_1Li5pYGGWgtqSxG4QsaC8EvZ","subtotal":300,"subtotal_excluding_tax":300,"tax":null,"test_clock":null,"total":300,"total_discount_amounts":[],"total_excluding_tax":300,"total_tax_amounts":[],"transfer_data":null,"webhooks_delivered_at":1666100260}],"has_more":false,"next_page":"WzE2NjU0ODE2MzcuMzU4NzcxXQ==","url":"/v1/invoices/search"}');
        } else if(req.getEndpoint().contains('WzE2NjU5MTA0NzMuMjgyNTQ5Nl0')){
            res.setBody('{"object":"search_result","data":[{"id":"pi_3LuGvlGGWgtqSxG40NwsV9FS","object":"payment_intent","amount":300,"amount_capturable":0,"amount_details":{"tip":{}},"amount_received":300,"application":null,"application_fee_amount":null,"automatic_payment_methods":null,"canceled_at":null,"cancellation_reason":null,"capture_method":"automatic","charges":{"object":"list","data":[{"id":"ch_3LuGvlGGWgtqSxG40cg4htBA","object":"charge","amount":300,"amount_captured":300,"amount_refunded":0,"application":null,"application_fee":null,"application_fee_amount":null,"balance_transaction":"txn_3LuGvlGGWgtqSxG4087ZRNcP","billing_details":{"address":{"city":null,"country":null,"line1":null,"line2":null,"postal_code":null,"state":null},"email":null,"name":"GAVINMCDONNELL","phone":null},"calculated_statement_descriptor":"CAREAUSTRALIA","captured":true,"created":'+ Datetime.now().getTime()/1000+',"currency":"aud","customer":"cus_MEIO6YQafQq7oj","description":"Subscriptionupdate","destination":null,"dispute":null,"disputed":false,"failure_balance_transaction":null,"failure_code":null,"failure_message":null,"fraud_details":{},"invoice":"in_1LuFzDGGWgtqSxG4225rYbC3","livemode":false,"metadata":{},"on_behalf_of":null,"order":null,"outcome":{"network_status":"approved_by_network","reason":null,"risk_level":"normal","risk_score":38,"seller_message":"Paymentcomplete.","type":"authorized"},"paid":true,"payment_intent":"pi_3LuGvlGGWgtqSxG40NwsV9FS","payment_method":"card_1LVpnbGGWgtqSxG4WvKYhBFD","payment_method_details":{"card":{"brand":"visa","checks":{"address_line1_check":null,"address_postal_code_check":null,"cvc_check":null},"country":"US","exp_month":3,"exp_year":2025,"fingerprint":"k3Oq1WWP1nBVr7hR","funding":"credit","installments":null,"last4":"4242","mandate":null,"network":"visa","three_d_secure":null,"wallet":null},"type":"card"},"receipt_email":null,"receipt_number":null,"receipt_url":"https://pay.stripe.com/receipts/invoices/CAcaFwoVYWNjdF8xTElrTEdHR1dndHFTeEc0KOzCu5oGMgbF-4STZO46LBaIbL5HOmOZ8YlSBy_1BO8xIKjFAPztZitEFH1O8_CPVFsrXq4y2npheDib?s=ap","refunded":false,"refunds":{"object":"list","data":[],"has_more":false,"total_count":0,"url":"/v1/charges/ch_3LuGvlGGWgtqSxG40cg4htBA/refunds"},"review":null,"shipping":null,"source":{"id":"card_1LVpnbGGWgtqSxG4WvKYhBFD","object":"card","address_city":null,"address_country":null,"address_line1":null,"address_line1_check":null,"address_line2":null,"address_state":null,"address_zip":null,"address_zip_check":null,"brand":"Visa","country":"US","customer":"cus_MEIO6YQafQq7oj","cvc_check":null,"dynamic_last4":null,"exp_month":3,"exp_year":2025,"fingerprint":"k3Oq1WWP1nBVr7hR","funding":"credit","last4":"4242","metadata":{},"name":"GAVINMCDONNELL","tokenization_method":null},"source_transfer":null,"statement_descriptor":null,"statement_descriptor_suffix":null,"status":"succeeded","transfer_data":null,"transfer_group":null}],"has_more":false,"total_count":1,"url":"/v1/charges?payment_intent=pi_3LuGvlGGWgtqSxG40NwsV9FS"},"client_secret":"pi_3LuGvlGGWgtqSxG40NwsV9FS_secret_UJBO5JbvnOgXJd74p4tUHsAuN","confirmation_method":"automatic","created":1666103889,"currency":"aud","customer":"cus_MEIO6YQafQq7oj","description":"Subscriptionupdate","invoice":"in_1LuFzDGGWgtqSxG4225rYbC3","last_payment_error":null,"livemode":false,"metadata":{},"next_action":null,"on_behalf_of":null,"payment_method":null,"payment_method_options":{"au_becs_debit":{},"card":{"installments":null,"mandate_options":null,"network":null,"request_three_d_secure":"automatic"}},"payment_method_types":["au_becs_debit","card"],"processing":null,"receipt_email":null,"review":null,"setup_future_usage":null,"shipping":null,"source":"card_1LVpnbGGWgtqSxG4WvKYhBFD","statement_descriptor":null,"statement_descriptor_suffix":null,"status":"succeeded","transfer_data":null,"transfer_group":null}],"has_more":false,"next_page":"WzE2NjU5MTA0NzMuMjgyNTQ5Nl0=","url":"/v1/payment_intents/search"}');
        } else if(req.getEndpoint().contains('WzE2NjU3NTYxNzkuNDU2ODcxNV0')){
            res.setBody('{"object":"search_result","data":[{"id":"ch_3LuGvlGGWgtqSxG40cg4htBA","object":"charge","amount":300,"amount_captured":300,"amount_refunded":0,"application":null,"application_fee":null,"application_fee_amount":null,"balance_transaction":"txn_3LuGvlGGWgtqSxG4087ZRNcP","billing_details":{"address":{"city":null,"country":null,"line1":null,"line2":null,"postal_code":null,"state":null},"email":null,"name":"GAVINMCDONNELL","phone":null},"calculated_statement_descriptor":"CAREAUSTRALIA","captured":true,"created":'+ Datetime.now().getTime()/1000+',"currency":"aud","customer":"cus_MEIO6YQafQq7oj","description":"Subscriptionupdate","destination":null,"dispute":null,"disputed":false,"failure_balance_transaction":null,"failure_code":null,"failure_message":null,"fraud_details":{},"invoice":"in_1LuFzDGGWgtqSxG4225rYbC3","livemode":false,"metadata":{},"on_behalf_of":null,"order":null,"outcome":{"network_status":"approved_by_network","reason":null,"risk_level":"normal","risk_score":38,"seller_message":"Paymentcomplete.","type":"authorized"},"paid":true,"payment_intent":"pi_3LuGvlGGWgtqSxG40NwsV9FS","payment_method":"card_1LVpnbGGWgtqSxG4WvKYhBFD","payment_method_details":{"card":{"brand":"visa","checks":{"address_line1_check":null,"address_postal_code_check":null,"cvc_check":null},"country":"US","exp_month":3,"exp_year":2025,"fingerprint":"k3Oq1WWP1nBVr7hR","funding":"credit","installments":null,"last4":"4242","mandate":null,"network":"visa","three_d_secure":null,"wallet":null},"type":"card"},"receipt_email":null,"receipt_number":null,"receipt_url":"https://pay.stripe.com/receipts/invoices/CAcaFwoVYWNjdF8xTElrTEdHR1dndHFTeEc0KPHBu5oGMgZjNCk9RwY6LBYQ7k-Adl4DrBr8nHJF02adPp-9hbIqy0SgPFVCMYgayTpIpJ_Z1D_ilZcX?s=ap","refunded":false,"refunds":{"object":"list","data":[],"has_more":false,"total_count":0,"url":"/v1/charges/ch_3LuGvlGGWgtqSxG40cg4htBA/refunds"},"review":null,"shipping":null,"source":{"id":"card_1LVpnbGGWgtqSxG4WvKYhBFD","object":"card","address_city":null,"address_country":null,"address_line1":null,"address_line1_check":null,"address_line2":null,"address_state":null,"address_zip":null,"address_zip_check":null,"brand":"Visa","country":"US","customer":"cus_MEIO6YQafQq7oj","cvc_check":null,"dynamic_last4":null,"exp_month":3,"exp_year":2025,"fingerprint":"k3Oq1WWP1nBVr7hR","funding":"credit","last4":"4242","metadata":{},"name":"GAVINMCDONNELL","tokenization_method":null},"source_transfer":null,"statement_descriptor":null,"statement_descriptor_suffix":null,"status":"succeeded","transfer_data":null,"transfer_group":null}],"has_more":false,"next_page":"WzE2NjU3NTYxNzkuNDU2ODcxNV0=","url":"/v1/charges/search"}');
        } else {
            system.debug('### Invalid endpoint.');
        }
        res.setStatusCode(statusCode);
        return res;
    }
}